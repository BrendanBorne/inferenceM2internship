# Statistical inference for a toy model of the spread of bovine viral diarrhea on a large scale

The aim of this git repository is to provide a possible implementation of a statistical inference algorithm for a large-scale stochastic epidemiological model. The inference method used is Approximate Bayesian Computation, and more specifically Sequential Monte Carlo.

More information about these methods can be found [here](https://onlinelibrary.wiley.com/doi/full/10.1111/j.1461-0248.2011.01640.x).

This work was produced during my Master's degree internship inside INRAE's DYNAMO team.

You can download the entire contents of this repository to test it on your machine via the `Code` then `Download ZIP` button, or by cloning the repository at home.

## Toy model

Although it could be adapted to any model, this version of the inference method is designed to work with the provided toy model.

This model was designed to mimic the behavior of the bovine viral diarrhea disease. One specificity of this disease is that it produces permanently infected yet immunotolerant animals (called PI). These PI calves are born from a cow that was infected between the 30th and 120th day of gestation (approximately). More information about this disease can be found [here](https://www.sciencedirect.com/science/article/pii/S0749072015304655).

The model sources are found in the __toymodel.py__ script. It is not designed to be run on its own, but a few tweaks could make it work.

## Parameter inference

The script implementing the statistical inference method is __ABC-SMC.py__.

This script relies on the following files to function:

* __toymodel.py__ : the toy model python script
* __execute_loop.py__ : the ABC main loop externalization script
* __arguments.json__ : a .json file containing information on the parameters to be estimated

### Needed data

To work properly, this script needs the data contained in the `data` folder:

* __network.csv__ : the herd network used by the toy model
* __observed_data.csv__ : the observation data used to infer

### Script execution

This script can be run from a terminal using the `python3` command.

The execution of this script must receive four arguments as input:

* __--arguments__ : path to the *arguments.json* file
* __--generations__ : the number of generations to run
* __--accparc__ : the number of accepted particles required for each generation
* __--maxruns__ : the maximum number of runs to be launched at each generation

Here's an example of how to run this script:

`python3 ABC-SMC.py --arguments arguments.json --generations 10 --accparc 500 --maxruns 5000`

The execution of this example should take about 30 minutes, depending on your machine.

### Script outputs

The outputs generated by the inference method are the following:

* __particles.csv__ : the accepted particles for each generation
* __tracking.csv__ : some useful data to track the script's performance

They are both exported to the `results` folder.

### Results visualization

The python notebook __ABC_analysis.ipynb__ takes a look at the results through a variety of plots.

## Dependencies

To run, the script needs [python3](https://www.python.org/) to be installed on your work environment. It was implemented with python3 version 3.10.6.

It also needs the following libraries:

* [numpy](https://numpy.org/doc/stable/index.html) (1.24.2)
* [scipy](https://scipy.org/) (1.10.0)
* [pandas](https://pandas.pydata.org/) (1.5.3)
* [psutil](https://pypi.org/project/psutil/) (5.9.0)

Other core libraries of python are used, but they usually come with every python3 installation.

Compatibility with different versions cannot be ensured.
